\hypertarget{twi__slave_8h_source}{}\doxysection{twi\+\_\+slave.\+h}
\label{twi__slave_8h_source}\index{susci/communication/twi\_slave.h@{susci/communication/twi\_slave.h}}
\mbox{\hyperlink{twi__slave_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * This file is part of the Susci project, an ultra lightweight general purpose}}
\DoxyCodeLine{3 \textcolor{comment}{ * operating system aimed at devices without an MMU module and with very little}}
\DoxyCodeLine{4 \textcolor{comment}{ * RAM memory.}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ * It is released under the terms of the MIT license, you can use Susca in your}}
\DoxyCodeLine{7 \textcolor{comment}{ * projects, you just need to mention it in the documentation, manual or other}}
\DoxyCodeLine{8 \textcolor{comment}{ * such place.}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * Author: Cixo}}
\DoxyCodeLine{11 \textcolor{comment}{ *}}
\DoxyCodeLine{12 \textcolor{comment}{ *}}
\DoxyCodeLine{13 \textcolor{comment}{ * This file stores the general data structures and functions needed by each}}
\DoxyCodeLine{14 \textcolor{comment}{ * TWI slave implementation for each platform. The elements contained therein}}
\DoxyCodeLine{15 \textcolor{comment}{ * constitute the basis on which the TWI slave implementation is then placed.}}
\DoxyCodeLine{16 \textcolor{comment}{ */}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef COMMUNICATION\_TWI\_SLAVE\_H\_INCLUDED }}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define COMMUNICATION\_TWI\_SLAVE\_H\_INCLUDED }}
\DoxyCodeLine{20 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define TWI\_SLAVE\_SEND\_SIGNAL 0x52}}
\DoxyCodeLine{25 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define TWI\_SLAVE\_RECEIVED\_SIGNAL 0x53}}
\DoxyCodeLine{30 }
\DoxyCodeLine{34 \textcolor{keyword}{typedef} uint8\_t \mbox{\hyperlink{twi__slave_8h_ad91b9d60e30c453fc4b5ac09b6f4a123}{twi\_frame\_t}};}
\DoxyCodeLine{35 }
\DoxyCodeLine{39 \textcolor{keyword}{typedef} uint8\_t \mbox{\hyperlink{twi__slave_8h_ac380919adb9e45a01899199857367f7f}{twi\_address\_t}};}
\DoxyCodeLine{40 }
\DoxyCodeLine{44 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{comment}{/* If master want to send data to slave */}}
\DoxyCodeLine{47     \mbox{\hyperlink{twi__slave_8h_afa067fe80c8f6cbe72f6d46439f1cb81a68a470c9a36fab44404714c9e199bb95}{WRITE\_MODE}} = 0,}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     \textcolor{comment}{/* If master want to receive data from slave */}}
\DoxyCodeLine{50     \mbox{\hyperlink{twi__slave_8h_afa067fe80c8f6cbe72f6d46439f1cb81aa2f18143cfa252aa4deb2736e690e8d2}{READ\_MODE}} = 1}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \} \mbox{\hyperlink{twi__slave_8h_afa067fe80c8f6cbe72f6d46439f1cb81}{twi\_transmission\_mode\_t}};}
\DoxyCodeLine{53 }
\DoxyCodeLine{57 \textcolor{keyword}{typedef} \textcolor{keyword}{enum} \{}
\DoxyCodeLine{58 }
\DoxyCodeLine{59     \textcolor{comment}{/* If TWI bas is off, or other device polled */}}
\DoxyCodeLine{60     \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beea40a067b9f249f5e6d1b1e55b667af2f5}{BUS\_OFF}} = 0,}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     \textcolor{comment}{/* If TWI master polled device */}}
\DoxyCodeLine{63     \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beea3e53ce980daa48690f64a4f134446939}{VERYFI\_POLLED\_ADDRESS}} = 1,}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     \textcolor{comment}{/* If slave device sending ACK to master */}}
\DoxyCodeLine{66     \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beea895e26798f794751ec25362040907eb9}{SEND\_CONFIRMATION\_TO\_MASTER}} = 2,}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{comment}{/* If slave device receiving ACK or NACK from master */}}
\DoxyCodeLine{69     \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beeaefe5012c1c1c55aa4b3f3bee4035038c}{RECEIVE\_CONFIRMATION\_FROM\_MASTER}} = 3,}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{comment}{/* If slave device sending data to master */}}
\DoxyCodeLine{72     \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beead5517cfca81f4033defb5eab40391b9d}{SEND\_DATA\_TO\_MASTER}} = 4,}
\DoxyCodeLine{73 }
\DoxyCodeLine{74     \textcolor{comment}{/* If slave device receiving data from master */}}
\DoxyCodeLine{75     \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beea4f30237239d595b6ffe2bcb42a53b76d}{RECEIVE\_DATA\_FROM\_MASTER}} = 5}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \} \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374bee}{twi\_state\_t}};}
\DoxyCodeLine{78 }
\DoxyCodeLine{82 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{comment}{/* This is current bus state */}}
\DoxyCodeLine{85     \textcolor{keyword}{volatile} \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374bee}{twi\_state\_t}} \mbox{\hyperlink{structtwi__interface__t_af7a45e24260277ba0082e70078e04de3}{state}};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     \textcolor{comment}{/* This is device address */}}
\DoxyCodeLine{88     \mbox{\hyperlink{twi__slave_8h_ac380919adb9e45a01899199857367f7f}{twi\_address\_t}} \mbox{\hyperlink{structtwi__interface__t_afeaefc8f30845948cfa37c700c7ed730}{address}};}
\DoxyCodeLine{89 }
\DoxyCodeLine{90     \textcolor{comment}{/* This is memory shared by slave device */}}
\DoxyCodeLine{91     \mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} \mbox{\hyperlink{structtwi__interface__t_a15c5b39a658d476aff17664a80b40eee}{shared}};}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \} \mbox{\hyperlink{structtwi__interface__t}{twi\_interface\_t}};}
\DoxyCodeLine{94 }
\DoxyCodeLine{100 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{structtwi__interface__t}{twi\_interface\_t}} \mbox{\hyperlink{twi__slave_8h_acd6ed9c131d604351eb3697b2646eef1}{create\_twi\_interface}}(\mbox{\hyperlink{twi__slave_8h_ac380919adb9e45a01899199857367f7f}{twi\_address\_t}} address) \{}
\DoxyCodeLine{101     \textcolor{keywordflow}{return} (\mbox{\hyperlink{structtwi__interface__t}{twi\_interface\_t}}) \{}
\DoxyCodeLine{102         \mbox{\hyperlink{twi__slave_8h_aa3bf02997a714adac2761648ef374beea40a067b9f249f5e6d1b1e55b667af2f5}{BUS\_OFF}},}
\DoxyCodeLine{103         address,}
\DoxyCodeLine{104         \mbox{\hyperlink{shared__memory_8h_ae82a1f0facfb6fca54185c11155f70e5}{create\_shared\_memory}} ()}
\DoxyCodeLine{105     \};}
\DoxyCodeLine{106 \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{113 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{twi__slave_8h_afa067fe80c8f6cbe72f6d46439f1cb81}{twi\_transmission\_mode\_t}} \mbox{\hyperlink{twi__slave_8h_ae9ef2f7210aaf914b4bbbd8f2ae5729c}{get\_twi\_transmission\_mode}}(}
\DoxyCodeLine{114     \mbox{\hyperlink{twi__slave_8h_ad91b9d60e30c453fc4b5ac09b6f4a123}{twi\_frame\_t}} frame}
\DoxyCodeLine{115 ) \{}
\DoxyCodeLine{116     \textcolor{keywordflow}{return} frame \& 0x01;}
\DoxyCodeLine{117 \}}
\DoxyCodeLine{118 }
\DoxyCodeLine{123 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{twi__slave_8h_ac380919adb9e45a01899199857367f7f}{twi\_address\_t}} \mbox{\hyperlink{twi__slave_8h_a91eea9af7cd81d4c23faa9164fef9b5d}{get\_twi\_control\_address}} (\mbox{\hyperlink{twi__slave_8h_ad91b9d60e30c453fc4b5ac09b6f4a123}{twi\_frame\_t}} frame) \{}
\DoxyCodeLine{124     \textcolor{keywordflow}{return} (\mbox{\hyperlink{twi__slave_8h_ac380919adb9e45a01899199857367f7f}{twi\_address\_t}}) (frame >> 1);}
\DoxyCodeLine{125 \}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127 }
\DoxyCodeLine{128 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
