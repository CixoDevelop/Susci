\hypertarget{shared__memory_8h_source}{}\doxysection{shared\+\_\+memory.\+h}
\label{shared__memory_8h_source}\index{susci/synchronization/shared\_memory.h@{susci/synchronization/shared\_memory.h}}
\mbox{\hyperlink{shared__memory_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{ * This file is part of the Susci project, an ultra lightweight general purpose}}
\DoxyCodeLine{3 \textcolor{comment}{ * operating system aimed at devices without an MMU module and with very little}}
\DoxyCodeLine{4 \textcolor{comment}{ * RAM memory.}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ * It is released under the terms of the MIT license, you can use Susca in your}}
\DoxyCodeLine{7 \textcolor{comment}{ * projects, you just need to mention it in the documentation, manual or other}}
\DoxyCodeLine{8 \textcolor{comment}{ * such place.}}
\DoxyCodeLine{9 \textcolor{comment}{ *}}
\DoxyCodeLine{10 \textcolor{comment}{ * Author: Cixo}}
\DoxyCodeLine{11 \textcolor{comment}{ *}}
\DoxyCodeLine{12 \textcolor{comment}{ *}}
\DoxyCodeLine{13 \textcolor{comment}{ * This file stores the structures and functions needed for the operation of}}
\DoxyCodeLine{14 \textcolor{comment}{ * SharedMemory. SharedMemory is a structure that allows you to share a}}
\DoxyCodeLine{15 \textcolor{comment}{ * memory area. It has a pointer to simplify data transfer from common memory}}
\DoxyCodeLine{16 \textcolor{comment}{ * space via UART, TWI or SPI. Unlike the cache, it doesn't require the use of}}
\DoxyCodeLine{17 \textcolor{comment}{ * a pointer, it's optional.}}
\DoxyCodeLine{18 \textcolor{comment}{ */}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#ifndef COMMUNICATION\_SHARED\_MEMORY\_H\_INCLUDED}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#define COMMUNICATION\_SHARED\_MEMORY\_H\_INCLUDED}}
\DoxyCodeLine{22 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifndef SHARED\_MEMORY\_SIZE}}
\DoxyCodeLine{27 \textcolor{preprocessor}{    \#define SHARED\_MEMORY\_SIZE 8}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{29 }
\DoxyCodeLine{33 \textcolor{preprocessor}{\#define SHARED\_MEMORY\_NULLPTR SHARED\_MEMORY\_SIZE}}
\DoxyCodeLine{34 }
\DoxyCodeLine{39 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{40 }
\DoxyCodeLine{41     \textcolor{comment}{/* Pointer used when accessing in sequence */}}
\DoxyCodeLine{42     \textcolor{keyword}{volatile} uint8\_t \mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}};}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     \textcolor{comment}{/* Memory space that is shared */}}
\DoxyCodeLine{45     \textcolor{keyword}{volatile} \textcolor{keywordtype}{char} area[\mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}}];}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \} \mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}};}
\DoxyCodeLine{48 }
\DoxyCodeLine{52 \textcolor{keyword}{static} \textcolor{keyword}{inline} \mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} \mbox{\hyperlink{shared__memory_8h_ae82a1f0facfb6fca54185c11155f70e5}{create\_shared\_memory}}(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{53     \textcolor{keywordflow}{return} (\mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}}) \{\mbox{\hyperlink{shared__memory_8h_a4b69aeb3402bbfa6b1cf5a05f010c4e5}{SHARED\_MEMORY\_NULLPTR}}, \{0x00\}\};}
\DoxyCodeLine{54 \}}
\DoxyCodeLine{55 }
\DoxyCodeLine{60 \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{shared__memory_8h_a8b79bf0a7b1932adfc1887080a27733f}{reset\_shared\_memory\_area}}(\mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared) \{}
\DoxyCodeLine{61     \textcolor{keywordflow}{for} (uint8\_t pointer = 0; pointer < \mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}}; ++ pointer)\{}
\DoxyCodeLine{62         shared-\/>\mbox{\hyperlink{structshared__memory__t_ad98142ae16dcdbc111b0d8a789b04509}{area}}[pointer] = 0x00;}
\DoxyCodeLine{63     \}}
\DoxyCodeLine{64 \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{70 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{shared__memory_8h_add8b13852d06f764e58738c763fe8695}{reset\_shared\_memory\_pointer}}(\mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared) \{}
\DoxyCodeLine{71     shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} = \mbox{\hyperlink{shared__memory_8h_a4b69aeb3402bbfa6b1cf5a05f010c4e5}{SHARED\_MEMORY\_NULLPTR}};}
\DoxyCodeLine{72 \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{79 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \mbox{\hyperlink{shared__memory_8h_a2855e388d05bf9428d4760346e0d4321}{is\_set\_shared\_memory\_pointer}}(\mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared) \{}
\DoxyCodeLine{80     \textcolor{keywordflow}{return} (\textcolor{keywordtype}{bool}) (shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} != \mbox{\hyperlink{shared__memory_8h_a4b69aeb3402bbfa6b1cf5a05f010c4e5}{SHARED\_MEMORY\_NULLPTR}});}
\DoxyCodeLine{81 \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{88 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{shared__memory_8h_a286a0bfa7dda06dff22eeaf8657ca9bb}{set\_shared\_memory\_pointer}}(}
\DoxyCodeLine{89     \mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared, }
\DoxyCodeLine{90     uint8\_t address}
\DoxyCodeLine{91 ) \{}
\DoxyCodeLine{92     shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} = address \% \mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}};}
\DoxyCodeLine{93 \}}
\DoxyCodeLine{94 }
\DoxyCodeLine{100 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{char} \mbox{\hyperlink{shared__memory_8h_aee24fd0818d8fcffa61fc7cfa9cb58af}{read\_shared\_memory\_area}}(}
\DoxyCodeLine{101     \mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared, }
\DoxyCodeLine{102     uint8\_t address}
\DoxyCodeLine{103 ) \{}
\DoxyCodeLine{104     \textcolor{keywordflow}{return} shared-\/>\mbox{\hyperlink{structshared__memory__t_ad98142ae16dcdbc111b0d8a789b04509}{area}}[address \% \mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}}];}
\DoxyCodeLine{105 \}}
\DoxyCodeLine{106 }
\DoxyCodeLine{113 \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{shared__memory_8h_a3527242c9c22fed8ec423fbb99af0235}{write\_shared\_memory\_area}}(}
\DoxyCodeLine{114     \mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared, }
\DoxyCodeLine{115     uint8\_t address, }
\DoxyCodeLine{116     \textcolor{keywordtype}{char} data}
\DoxyCodeLine{117 ) \{}
\DoxyCodeLine{118     shared-\/>\mbox{\hyperlink{structshared__memory__t_ad98142ae16dcdbc111b0d8a789b04509}{area}}[address \% \mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}}] = data;}
\DoxyCodeLine{119 \}}
\DoxyCodeLine{120 }
\DoxyCodeLine{126 \textcolor{keyword}{static} \textcolor{keywordtype}{char} \mbox{\hyperlink{shared__memory_8h_a641411dcbf897fcf7532b0eb45031f7a}{read\_shared\_memory}}(\mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared) \{}
\DoxyCodeLine{127     shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} = shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} \% \mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}};}
\DoxyCodeLine{128 }
\DoxyCodeLine{129     \textcolor{keywordflow}{return} shared-\/>\mbox{\hyperlink{structshared__memory__t_ad98142ae16dcdbc111b0d8a789b04509}{area}}[shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}}++];}
\DoxyCodeLine{130 \}}
\DoxyCodeLine{131 }
\DoxyCodeLine{138 \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{shared__memory_8h_a6a235bd8a8017c2f9cc13030c0dcd5b1}{write\_shared\_memory}}(\mbox{\hyperlink{structshared__memory__t}{shared\_memory\_t}} *shared, \textcolor{keywordtype}{char} data) \{}
\DoxyCodeLine{139     shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} = shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}} \% \mbox{\hyperlink{shared__memory_8h_a21a16aec41293c80beb10d71f79ad7a2}{SHARED\_MEMORY\_SIZE}};}
\DoxyCodeLine{140 }
\DoxyCodeLine{141     shared-\/>\mbox{\hyperlink{structshared__memory__t_ad98142ae16dcdbc111b0d8a789b04509}{area}}[shared-\/>\mbox{\hyperlink{structshared__memory__t_a3f8a1abaf15aa20a6df662d8032e5b15}{pointer}}++] = data;}
\DoxyCodeLine{142 \}}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
